
<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>act.discovery.improve &#8212; Atmospheric data Community Toolkit 0.post1+g849e4ec documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/act-theme.css?v=e2ee527d" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=0643ce50"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/act/discovery/improve';</script>
    <script src="../../../_static/doc_shared.js?v=4c9803b4"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.post1+g849e4ec" /> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../../blog/atom.xml"
  title="ACT Blog"
/>
  
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Atmospheric data Community Toolkit 0.post1+g849e4ec documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../userguide/GUIDE_V2.html">
    ACT Version 2 Release Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../userguide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../API/index.html">
    API Reference Manual
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/auto_examples/index.html">
    ACT Example Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../blog.html">
    Blog
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://github.com/ARM-DOE/ACT/issues">
    GitHub Issue Tracker
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ARM-DOE/ACT" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../userguide/GUIDE_V2.html">
    ACT Version 2 Release Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../userguide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../API/index.html">
    API Reference Manual
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../source/auto_examples/index.html">
    ACT Example Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../blog.html">
    Blog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/ARM-DOE/ACT/issues">
    GitHub Issue Tracker
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ARM-DOE/ACT" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">Module code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">act.discovery.improve</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                   <h1>Source code for act.discovery.improve</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Script for downloading data from the IMPROVE network</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>


<div class="viewcode-block" id="get_improve_data"><a class="viewcode-back" href="../../../API/generated/act.discovery.get_improve_data.html#act.discovery.get_improve_data">[docs]</a><span class="k">def</span> <span class="nf">get_improve_data</span><span class="p">(</span><span class="n">site_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parameter_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve IMPROVE data for the given site and variable ids and store it in an</span>
<span class="sd">    xarray dataset. Documentation on the IMPROVE data can be found at</span>
<span class="sd">    https://vista.cira.colostate.edu/Improve/data-user-guide/</span>

<span class="sd">    Also adds in metadata from the site summary page to the global attributes</span>
<span class="sd">    https://views.cira.colostate.edu/adms/Pub/SiteSummary.aspx?dsidse=10001&amp;siidse=244</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    site_id : str</span>
<span class="sd">        Site id number which can be retrieved from the IMPROVE page for each site such as</span>
<span class="sd">        https://views.cira.colostate.edu/adms/Pub/SiteSummary.aspx?dsidse=10001&amp;siidse=244</span>
<span class="sd">    parameter_id : list</span>
<span class="sd">        List of parameter id values to retrieve from the API.</span>
<span class="sd">    start_date : str</span>
<span class="sd">        Start date formatted as M/D/YEAR such as 1/31/2022</span>
<span class="sd">    end_date : str</span>
<span class="sd">        End date formatted as M/D/YEAR such as 1/31/2022</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ds : xarray.Dataset</span>
<span class="sd">        Returns an Xarray dataset object</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    act.discovery.get_improve_data(site_id=&#39;244&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Build URL</span>
    <span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://views.cira.colostate.edu/fed/svc/DataSvc.aspx?action=getqueryresults&amp;cmdfileid=ServiceSqlCommandFile&amp;cmdid=BasicDataQuery1_Codes&#39;</span>

    <span class="k">if</span> <span class="n">site_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Please provide a site_id&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base_url</span> <span class="o">+=</span> <span class="s1">&#39;&amp;dsidse=10001&amp;siidse=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">site_id</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">parameter_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">base_url</span> <span class="o">+=</span> <span class="s1">&#39;&amp;paidse=101,136,907,900,102,104,105,115,116,117,114,3778,142,143,144,145,3016,146,3699,141,3779,3217,108,109,112,113,301,304,303,3716,3717,3718,3719,3720,3721,3722,3730,3731,3732,3733,3734,3735,3736,3694,121,3723,3724,3725,3726,3727,3728,3729,3737,3738,3739,3740,3741,3742,3743,118,148,128,130,132,941,127,903,910,3744,3745,3746,3747,3748,3749,3750,3751,3752,3753,3754,3755,3756,3757,131,138,139,133,3704,3705,3706,3707,3708,3709,3710,3711,3712,3713,3714,3715,147,124,150,3695,3014,153,154,134,911,158,156,151,202,159,160,162,163&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base_url</span> <span class="o">+=</span> <span class="s1">&#39;&amp;paidse=&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parameter_id</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">start_date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Please provide a start date&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base_url</span> <span class="o">+=</span> <span class="s1">&#39;&amp;sd=&#39;</span> <span class="o">+</span> <span class="n">start_date</span>
    <span class="k">if</span> <span class="n">end_date</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Please provide an end date&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base_url</span> <span class="o">+=</span> <span class="s1">&#39;&amp;ed=&#39;</span> <span class="o">+</span> <span class="n">end_date</span>

    <span class="c1"># Read data and get variables</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">base_url</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">variables</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Param</span><span class="p">)</span>

    <span class="c1"># Print out proper acknowledgement</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please use the following acknowledgment when using IMPROVE data:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;IMPROVE is a collaborative association of state, tribal, and federal agencies, and international partners. US Environmental Protection Agency is the primary funding source, with contracting and research support from the National Park Service. The Air Quality Group at the University of California, Davis is the central analytical laboratory, with ion analysis provided by Research Triangle Institute, and carbon analysis provided by Desert Research Institute.&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Creat mapping of variable names to metadata</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ALf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;aluminum_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Aluminum (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88104&#39;</span><span class="p">},</span>
        <span class="s1">&#39;ASf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;arsenic_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Arsenic (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88103&#39;</span><span class="p">},</span>
        <span class="s1">&#39;BRf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;bromine_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Bromine (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88109&#39;</span><span class="p">},</span>
        <span class="s1">&#39;CAf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;calcium_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calcium (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88111&#39;</span><span class="p">},</span>
        <span class="s1">&#39;CLf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;chlorine_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chlorine (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88115&#39;</span><span class="p">},</span>
        <span class="s1">&#39;CRf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;chromium_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chromium (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88112&#39;</span><span class="p">},</span>
        <span class="s1">&#39;CUf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;copper_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Copper (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88114&#39;</span><span class="p">},</span>
        <span class="s1">&#39;FEf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;iron_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Iron (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88126&#39;</span><span class="p">},</span>
        <span class="s1">&#39;PBf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;lead_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Lead (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88128&#39;</span><span class="p">},</span>
        <span class="s1">&#39;MGf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;magnesium_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Magnesium (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88140&#39;</span><span class="p">},</span>
        <span class="s1">&#39;MNf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;manganese_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Manganese (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88132&#39;</span><span class="p">},</span>
        <span class="s1">&#39;NIf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;nickel_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Nickel (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88136&#39;</span><span class="p">},</span>
        <span class="s1">&#39;Pf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;phosphorus_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Phosphorus (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88152&#39;</span><span class="p">},</span>
        <span class="s1">&#39;Kf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;potassium_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Potassium (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88180&#39;</span><span class="p">},</span>
        <span class="s1">&#39;RBf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;rubidium_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Rubidium (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88176&#39;</span><span class="p">},</span>
        <span class="s1">&#39;SEf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;selenium_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Selenium (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88154&#39;</span><span class="p">},</span>
        <span class="s1">&#39;SIf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;silicon_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Silicon (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88165&#39;</span><span class="p">},</span>
        <span class="s1">&#39;NAf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;sodium_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sodium (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88184&#39;</span><span class="p">},</span>
        <span class="s1">&#39;SRf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;strontium_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Strontium (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88168&#39;</span><span class="p">},</span>
        <span class="s1">&#39;Sf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;sulfur_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sulfur (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88169&#39;</span><span class="p">},</span>
        <span class="s1">&#39;TIf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;titanium_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Titanium (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88161&#39;</span><span class="p">},</span>
        <span class="s1">&#39;Vf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;vanadium_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Vanadium (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88164&#39;</span><span class="p">},</span>
        <span class="s1">&#39;ZNf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;zinc_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Zinc (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88167&#39;</span><span class="p">},</span>
        <span class="s1">&#39;ZRf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;zirconium_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Zirconium (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88185&#39;</span><span class="p">},</span>
        <span class="s1">&#39;CHLf&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;chloride_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chloride (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88203&#39;</span><span class="p">},</span>
        <span class="s1">&#39;NO3f&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;nitrate_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Nitrate (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88306&#39;</span><span class="p">},</span>
        <span class="s1">&#39;N2f&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;nitrite_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Nitrite (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88338&#39;</span><span class="p">},</span>
        <span class="s1">&#39;SO4f&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;sulfate_fine&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sulfate (Fine)&#39;</span><span class="p">,</span> <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88403&#39;</span><span class="p">},</span>
        <span class="s1">&#39;OC1f&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_organic_fraction_1_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Organic Fraction 1 (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;TOR, pure helium (&gt;99.999%) atmosphere, temperature (T) = 140 °C&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88324&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;OC2f&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_organic_fraction_2_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Organic Fraction 2 (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;TOR, pure helium (&gt;99.999%) atmosphere, temperature (T) = 280 °C&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88325&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;OC3f&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_organic_fraction_3_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Organic Fraction 3 (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;TOR, pure helium (&gt;99.999%) atmosphere, temperature (T) = 480 °C&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88326&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;OC4f&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_organic_fraction_4_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Organic Fraction 4 (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;TOR, pure helium (&gt;99.999%) atmosphere, temperature (T) = 580 °C&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88327&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;OPf&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_organic_reflectance_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Organic Pyrolized (Fine) by Reflectance&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;TOR, carbon that is measured after the introduction of helium/oxygen atmosphere at °550 C but beforereflectance returns to initial value&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88328&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;OPTf&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_organic_transmittance_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Organic Pyrolized (Fine) by Transmittance&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;TOR, carbon that is measured after the introduction of helium/oxygen atmosphere at °550 C but beforetransmittance returns to initial value&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88336&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;OCf&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_organic_total_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Organic Total (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Organic carbon from TOR carbon fractions (OC1f+OC2f+OC3f+OC4f+OPf)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88320&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;EC1f&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_elemental_fraction_1_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Elemental Fraction 1 (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;TOR, 98</span><span class="si">% he</span><span class="s1">lium, 2</span><span class="si">% o</span><span class="s1">xygen atmosphere, temperature (T) = 580° C.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88329&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;EC2f&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_elemental_fraction_2_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Elemental Fraction 2 (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;TOR, 98</span><span class="si">% he</span><span class="s1">lium, 2</span><span class="si">% o</span><span class="s1">xygen atmosphere, temperature (T) = 740° C.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88380&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;EC3f&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_elemental_fraction_3_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Elemental Fraction 3 (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;TOR, 98</span><span class="si">% he</span><span class="s1">lium, 2</span><span class="si">% o</span><span class="s1">xygen atmosphere, temperature (T) = 840° C.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88331&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;ECf&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_elemental_total_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Elemental Total (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Elemental carbon from TOR carbon fractions (E1+E2+E3-OP)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88321&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;fAbs&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;filter_absorption_coeff&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Filter Absorption Coefficient&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;A calibrated absorption coefficient measured from a Teflon filter using a hybrid integrating plate and sphere (HIPS) method&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;63102&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;FlowRate&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;flow_rate&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Flow Rate&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;The rate of air flow through an air sampling instrument&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;63102&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;MF&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;mass_pm2_5&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mass, PM2.5 (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Gravimetric mass measurement for particles with aerodynamic diameters less than 2.5 um&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;88101&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;MT&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;mass_pm10&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mass, PM10 (Total)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Gravimetric mass measurement for particles with aerodynamic diameters less than 10 um&#39;</span><span class="p">,</span>
            <span class="s1">&#39;epa_code&#39;</span><span class="p">:</span> <span class="s1">&#39;85101&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;SampDur&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;sample_duration&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sampling Duration&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;The duration of a given sampling period in minutes&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;ammNO3f&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ammonium_nitrate_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Ammonium Nitrate (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;1.29 x  NO3f&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;ammSO4f&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ammonium_sulfate_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Ammonium Sulfate (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;1.375 x SO4f&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;OMCf&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_organic_mass_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Organic Mass (fine)(1.8*OC)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;1.8 X OCf&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;TCf&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;carbon_total_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Carbon, Total (fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;From TOR carbon fractions (OCf+ECf)&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;CM_calculated&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CM_calculated&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mass, PM10-PM2.5 (Coarse)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;MT-MF&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;SeaSaltf&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;sea_salt_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sea Salt (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;1.8XCHLf&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;SOILf&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;soil_fine&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Soil (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;2.2 × ALf + 2.49 × SIf + 1.63 × CAf + 2.42 × FEf + 1.94 × TIf&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;RCFM&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;mass_pm2_5_reconstructed&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mass, PM2.5 Reconstructed (Fine)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Sum of ammSO4f, ammNO3f, OMCf, ECf, soilf, and seasaltf.&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;RCTM&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;mass_pmi10_reconstructed&#39;</span><span class="p">,</span>
            <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mass, PM10 Reconstructed (Total)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Sum of ammSO4f, ammNO3f, OMCf, ECf, soilf, seasaltf, and CM_calculated.&#39;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="n">laser_vars</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;RefF&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;ratio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Final laser reflectance at &#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;final_laser_reflectance_&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;TransF&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;ratio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Final laser transmittance at &#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;final_laser_transmittance_&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;RefI&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;ratio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Initial laser reflectance at &#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;initial_laser_reflectance_&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;TransI&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;ratio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Initial laser transmittance at &#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;initial_laser_transmittance_&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;RefM&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;ratio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Minimum laser reflectance at &#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;min_laser_reflectance_&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;TransM&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;ratio&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39; Minimum laser transmittance at &#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;min_laser_transmittance_&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;OP_TR&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;ug m-3&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Organic Pyrolyzed Carbon by Reflectance at &#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;organic_pyrolyzed_carbon_reflectance_&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;OP_TT&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;ug m-3&#39;</span><span class="p">,</span>
            <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Organic Pyrolyzed Carbon by Transmittance at &#39;</span><span class="p">,</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;organic_pyrolyzed_carbon_transmittance_&#39;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
    <span class="n">laser_wl</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;405&#39;</span><span class="p">,</span> <span class="s1">&#39;445&#39;</span><span class="p">,</span> <span class="s1">&#39;532&#39;</span><span class="p">,</span> <span class="s1">&#39;635&#39;</span><span class="p">,</span> <span class="s1">&#39;780&#39;</span><span class="p">,</span> <span class="s1">&#39;808&#39;</span><span class="p">,</span> <span class="s1">&#39;980&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">laser_vars</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">wl</span> <span class="ow">in</span> <span class="n">laser_wl</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">laser_vars</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">wl</span>
            <span class="k">if</span> <span class="s1">&#39;OP&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                <span class="n">mapping</span><span class="p">[</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">v</span><span class="p">,</span> <span class="n">wl</span><span class="p">])]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="n">laser_vars</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;units&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                    <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">laser_vars</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;comments&#39;</span><span class="p">],</span> <span class="n">wl</span><span class="p">]),</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">var_name</span> <span class="o">=</span> <span class="n">wl</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">))</span>
                <span class="n">mapping</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="n">laser_vars</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;units&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                    <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">laser_vars</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;comments&#39;</span><span class="p">],</span> <span class="n">wl</span><span class="p">]),</span>
                <span class="p">}</span>

    <span class="c1"># Run through each variable in the dataframe and add it to a dataset</span>
    <span class="c1"># along with the appropriate metadata</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">site</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Site</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">base_url</span><span class="p">,</span> <span class="s1">&#39;datastream&#39;</span><span class="p">:</span> <span class="n">site</span> <span class="o">+</span> <span class="s1">&#39; IMPROVE&#39;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
        <span class="c1"># Find data for just the variable in question</span>
        <span class="n">poc_attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Parameter Occurrence Code for &#39;</span> <span class="o">+</span> <span class="n">v</span><span class="p">}</span>
        <span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Param</span> <span class="o">==</span> <span class="n">v</span><span class="p">]</span>

        <span class="c1"># Get metadata</span>
        <span class="n">unit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">UnitAbbr</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Multiple types of units detected, using first one&#39;</span><span class="p">)</span>

        <span class="n">sites</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">Site</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sites</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Multiple sites detected, please use only one&#39;</span><span class="p">)</span>

        <span class="c1"># Get time, POC, and data</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">FactDate</span><span class="p">)</span>
        <span class="n">poc</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">POC</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">FactValue</span>

        <span class="c1"># Set up attributes</span>
        <span class="n">var_attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="n">unit</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="n">mapping</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;long_name&#39;</span><span class="p">],</span> <span class="s1">&#39;_FillValue&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">999.0</span><span class="p">}</span>
        <span class="k">if</span> <span class="s1">&#39;comments&#39;</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
            <span class="n">var_attrs</span><span class="p">[</span><span class="s1">&#39;comments&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;comments&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;epa_code&#39;</span> <span class="ow">in</span> <span class="n">mapping</span><span class="p">[</span><span class="n">v</span><span class="p">]:</span>
            <span class="n">var_attrs</span><span class="p">[</span><span class="s1">&#39;epa_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;epa_code&#39;</span><span class="p">]</span>

        <span class="c1"># If the first variable, create the dataset and then add variables to it</span>
        <span class="k">if</span> <span class="n">ct</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
                <span class="n">data_vars</span><span class="o">=</span><span class="p">{</span><span class="n">mapping</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span> <span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">var_attrs</span><span class="p">)},</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">},</span>
                <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;poc_&#39;</span> <span class="o">+</span> <span class="n">mapping</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">poc</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">},</span> <span class="n">attrs</span><span class="o">=</span><span class="n">poc_attrs</span>
            <span class="p">)</span>
            <span class="n">ct</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ds</span><span class="p">[</span><span class="n">mapping</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">},</span> <span class="n">attrs</span><span class="o">=</span><span class="n">var_attrs</span>
            <span class="p">)</span>
            <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;poc_&#39;</span> <span class="o">+</span> <span class="n">mapping</span><span class="p">[</span><span class="n">v</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">poc</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">},</span> <span class="n">attrs</span><span class="o">=</span><span class="n">poc_attrs</span>
            <span class="p">)</span>

    <span class="c1"># Add in metadata from site summary page</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://views.cira.colostate.edu/adms/Pub/SiteSummary.aspx?dsidse=10001&amp;siidse=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
        <span class="n">site_id</span>
    <span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="c1"># Add lat/lon as variables</span>
        <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">:</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;North latitude&#39;</span><span class="p">,</span>
                <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degree_N&#39;</span><span class="p">,</span>
                <span class="s1">&#39;valid_min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">90.0</span><span class="p">,</span>
                <span class="s1">&#39;valid_max&#39;</span><span class="p">:</span> <span class="mf">90.0</span><span class="p">,</span>
                <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span>
                <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">},</span>
                <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">:</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;East longitude&#39;</span><span class="p">,</span>
                <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;degree_E&#39;</span><span class="p">,</span>
                <span class="s1">&#39;valid_min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">180.0</span><span class="p">,</span>
                <span class="s1">&#39;valid_max&#39;</span><span class="p">:</span> <span class="mf">180.0</span><span class="p">,</span>
                <span class="s1">&#39;standard_name&#39;</span><span class="p">:</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span>
                <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">},</span>
                <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Add in problem information from the site summary page</span>
    <span class="n">problem</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">problem</span> <span class="o">+=</span> <span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;EventDate&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;EventType&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;Notes&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;site_problems&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">problem</span>

    <span class="k">return</span> <span class="n">ds</span></div>
</pre></div>
<div class="section ablog__blog_comments">
   
</div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2018-2024, ACT Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>